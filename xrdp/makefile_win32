# borland windows makefile
#
# this assumes openssl and borland free command line tools are installed
# this assumes c:\windows is windows directory
#
# run 'set PATH=c:\borland\bcc55\bin' and run 'make -f makefile_win32 all'
#

XRDPOBJ = xrdp.obj xrdp_tcp.obj xrdp_iso.obj xrdp_mcs.obj \
          xrdp_sec.obj xrdp_rdp.obj xrdp_process.obj xrdp_listen.obj \
          xrdp_orders.obj xrdp_bitmap.obj xrdp_wm.obj xrdp_painter.obj \
          xrdp_list.obj xrdp_region.obj xrdp_cache.obj xrdp_font.obj \
          funcs.obj xrdp_login_wnd.obj xrdp_file.obj xrdp_interface.obj \
          xrdp_bitmap_compress.obj \
          os_calls.obj

CFLAGS = -w- -O2 -I../common
C_OS_FLAGS = -w- -O2 -Ic:/borland/bcc55/include -Ic:/openssl/include -DUSE_OPENSSL -c
LDFLAGS = -Lc:/borland/bcc55/lib

xrdp: $(XRDPOBJ)
	$(CC) $(LDFLAGS) libeay32.lib $(XRDPOBJ)

all: lib xrdp

clean:
	del $(XRDPOBJ) xrdp.exe

lib:
	implib -a -w libeay32.lib c:/windows/system32/libeay32.dll

os_calls.obj:
	$(CC) $(C_OS_FLAGS) ../common/os_calls.c
